# Shaker智能鸡尾酒推荐系统项目文件结构规范

## 📋 文档信息
| 项目 | 内容 |
|------|------|
| **产品名称** | Shaker |
| **版本号** | MVP版本1.0.0 |
| **文档版本** | v1.0 |
| **创建日期** | 2024-08-28 |
| **项目负责人** | 郭锐 |
| **文档状态** | ✅ 已完成 | 

---

## 🎯 文件结构总览

```
shaker/
├── 📁 frontend/                    # 前端应用
├── 📁 backend/                     # 后端API服务
├── 📁 docs/                        # 项目文档
├── 📁 scripts/                     # 脚本工具
├── 📁 .github/                     # GitHub配置
├── 📄 README.md                    # 项目说明
├── 📄 .gitignore                   # Git忽略文件
├── 📄 LICENSE                      # 开源协议
└── 📄 package.json                 # 根项目配置
```

---

## 🎨 前端文件结构

### 完整前端目录树
```
frontend/
├── 📁 public/                      # 静态资源
│   ├── 🖼️ favicon.ico              # 网站图标
│   ├── 🖼️ logo.svg                 # 品牌Logo
│   ├── 🖼️ images/                  # 图片资源
│   │   ├── cocktail-icons/         # 鸡尾酒图标
│   │   ├── ingredient-icons/       # 材料图标
│   │   └── scene-backgrounds/      # 场景背景
│   └── 📄 index.html               # HTML模板
├── 📁 src/                         # 源代码
│   ├── 📁 components/              # React组件
│   │   ├── 📁 ui/                  # 基础UI组件
│   │   │   ├── 📄 Button.tsx       # 按钮组件
│   │   │   ├── 📄 Card.tsx         # 卡片组件
│   │   │   ├── 📄 Input.tsx        # 输入框组件
│   │   │   ├── 📄 Modal.tsx        # 模态框组件
│   │   │   ├── 📄 Slider.tsx       # 滑块组件
│   │   │   ├── 📄 Checkbox.tsx     # 复选框组件
│   │   │   ├── 📄 Loading.tsx      # 加载组件
│   │   │   └── 📄 index.ts         # 组件导出
│   │   ├── 📁 forms/               # 表单组件
│   │   │   ├── 📄 SceneSelector.tsx          # 场景选择器
│   │   │   ├── 📄 MoodPicker.tsx             # 心情选择器
│   │   │   ├── 📄 IngredientSelector.tsx     # 材料选择器
│   │   │   ├── 📄 PreferenceSlider.tsx       # 偏好滑块
│   │   │   └── 📄 SpecialRequirements.tsx    # 特殊要求
│   │   ├── 📁 layout/              # 布局组件
│   │   │   ├── 📄 Header.tsx       # 页头组件
│   │   │   ├── 📄 Footer.tsx       # 页脚组件
│   │   │   ├── 📄 Sidebar.tsx      # 侧边栏组件
│   │   │   └── 📄 Container.tsx    # 容器组件
│   │   └── 📁 cocktail/            # 鸡尾酒相关组件
│   │       ├── 📄 CocktailCard.tsx           # 鸡尾酒卡片
│   │       ├── 📄 CocktailDetail.tsx         # 鸡尾酒详情
│   │       ├── 📄 RecipeList.tsx             # 配方列表
│   │       └── 📄 InstructionSteps.tsx       # 制作步骤
│   ├── 📁 pages/                   # 页面组件
│   │   ├── 📄 HomePage.tsx         # 首页
│   │   ├── 📄 RecommendPage.tsx    # 推荐页面
│   │   ├── 📄 ResultPage.tsx       # 结果页面
│   │   ├── 📄 DetailPage.tsx       # 详情页面
│   │   └── 📄 ErrorPage.tsx        # 错误页面
│   ├── 📁 stores/                  # 状态管理
│   │   ├── 📄 useAppStore.ts       # 应用状态
│   │   ├── 📄 useUserInputStore.ts # 用户输入状态
│   │   ├── 📄 useRecommendStore.ts # 推荐状态
│   │   └── 📄 index.ts             # 状态导出
│   ├── 📁 services/                # API服务
│   │   ├── 📄 api.ts               # API客户端
│   │   ├── 📄 recommendService.ts  # 推荐服务
│   │   ├── 📄 ingredientService.ts # 材料服务
│   │   └── 📄 types.ts             # API类型定义
│   ├── 📁 hooks/                   # 自定义Hooks
│   │   ├── 📄 useRecommendation.ts # 推荐Hook
│   │   ├── 📄 useLocalStorage.ts   # 本地存储Hook
│   │   ├── 📄 useDebounce.ts       # 防抖Hook
│   │   └── 📄 useAsync.ts          # 异步Hook
│   ├── 📁 utils/                   # 工具函数
│   │   ├── 📄 helpers.ts           # 通用帮助函数
│   │   ├── 📄 validation.ts        # 验证函数
│   │   ├── 📄 formatting.ts        # 格式化函数
│   │   ├── 📄 constants.ts         # 常量定义
│   │   └── 📄 storage.ts           # 存储工具
│   ├── 📁 types/                   # TypeScript类型
│   │   ├── 📄 index.ts             # 通用类型
│   │   ├── 📄 cocktail.ts          # 鸡尾酒类型
│   │   ├── 📄 user.ts              # 用户类型
│   │   └── 📄 api.ts               # API类型
│   ├── 📁 assets/                  # 资源文件
│   │   ├── 📁 styles/              # 样式文件
│   │   │   ├── 📄 globals.css      # 全局样式
│   │   │   ├── 📄 components.css   # 组件样式
│   │   │   └── 📄 utilities.css    # 工具样式
│   │   └── 📁 fonts/               # 字体文件
│   ├── 📁 __tests__/               # 测试文件
│   │   ├── 📁 components/          # 组件测试
│   │   ├── 📁 pages/               # 页面测试
│   │   ├── 📁 utils/               # 工具测试
│   │   └── 📄 setup.ts             # 测试配置
│   ├── 📄 App.tsx                  # 应用根组件
│   ├── 📄 main.tsx                 # 应用入口
│   └── 📄 vite-env.d.ts            # Vite类型声明
├── 📄 package.json                 # 项目配置
├── 📄 vite.config.ts               # Vite配置
├── 📄 tailwind.config.js           # Tailwind配置
├── 📄 postcss.config.js            # PostCSS配置
├── 📄 tsconfig.json                # TypeScript配置
├── 📄 tsconfig.node.json           # Node TypeScript配置
├── 📄 .eslintrc.json               # ESLint配置
├── 📄 .prettierrc                  # Prettier配置
├── 📄 .env.example                 # 环境变量示例
└── 📄 README.md                    # 前端说明文档
```

### 前端命名规范

#### 文件命名规范
```typescript
// 组件文件 - PascalCase
Button.tsx
CocktailCard.tsx
IngredientSelector.tsx

// Hook文件 - camelCase + use前缀
useRecommendation.ts
useLocalStorage.ts
useDebounce.ts

// 工具文件 - camelCase
helpers.ts
validation.ts
constants.ts

// 类型文件 - camelCase
index.ts
cocktail.ts
user.ts

// 样式文件 - kebab-case
globals.css
components.css
utilities.css
```

#### 组件内部结构规范
```typescript
// 组件文件结构示例
import React from 'react';
import { type ComponentProps } from '@/types';
import { cn } from '@/utils/helpers';

// 1. 类型定义
interface ButtonProps extends ComponentProps {
  variant: 'primary' | 'secondary';
  size: 'sm' | 'md' | 'lg';
  loading?: boolean;
}

// 2. 组件实现
export const Button: React.FC<ButtonProps> = ({
  variant = 'primary',
  size = 'md',
  loading = false,
  className,
  children,
  ...props
}) => {
  // Hook调用
  const [isPressed, setIsPressed] = useState(false);
  
  // 计算属性
  const buttonClasses = cn(
    'base-button-classes',
    {
      'primary-classes': variant === 'primary',
      'secondary-classes': variant === 'secondary',
      'sm-classes': size === 'sm',
      'md-classes': size === 'md',
      'lg-classes': size === 'lg',
      'loading-classes': loading,
    },
    className
  );
  
  // 事件处理
  const handleClick = () => {
    setIsPressed(true);
    // 处理逻辑
  };
  
  // 渲染
  return (
    <button
      className={buttonClasses}
      onClick={handleClick}
      disabled={loading}
      {...props}
    >
      {loading ? <LoadingSpinner /> : children}
    </button>
  );
};

// 3. 默认导出
export default Button;
```

---

## 🔧 后端文件结构

### 完整后端目录树
```
backend/
├── 📁 src/                         # 源代码
│   ├── 📁 controllers/             # 控制器层
│   │   ├── 📄 healthController.ts          # 健康检查控制器
│   │   ├── 📄 recommendController.ts       # 推荐控制器
│   │   ├── 📄 ingredientController.ts      # 材料控制器
│   │   └── 📄 index.ts                     # 控制器导出
│   ├── 📁 services/                # 业务逻辑层
│   │   ├── 📄 cozeService.ts               # Coze AI服务
│   │   ├── 📄 recommendService.ts          # 推荐业务逻辑
│   │   ├── 📄 promptBuilder.ts             # Prompt构建器
│   │   ├── 📄 responseParser.ts            # 响应解析器
│   │   └── 📄 cacheService.ts              # 缓存服务
│   ├── 📁 middleware/              # 中间件
│   │   ├── 📄 cors.ts                      # CORS配置
│   │   ├── 📄 helmet.ts                    # 安全中间件
│   │   ├── 📄 logger.ts                    # 日志中间件
│   │   ├── 📄 errorHandler.ts              # 错误处理
│   │   ├── 📄 validation.ts                # 请求验证
│   │   ├── 📄 rateLimit.ts                 # 频率限制
│   │   └── 📄 index.ts                     # 中间件导出
│   ├── 📁 routes/                  # 路由定义
│   │   ├── 📄 health.ts                    # 健康检查路由
│   │   ├── 📄 recommend.ts                 # 推荐路由
│   │   ├── 📄 ingredient.ts                # 材料路由
│   │   └── 📄 index.ts                     # 路由汇总
│   ├── 📁 types/                   # TypeScript类型
│   │   ├── 📄 index.ts                     # 通用类型
│   │   ├── 📄 request.ts                   # 请求类型
│   │   ├── 📄 response.ts                  # 响应类型
│   │   ├── 📄 cocktail.ts                  # 鸡尾酒类型
│   │   ├── 📄 coze.ts                      # Coze API类型
│   │   └── 📄 error.ts                     # 错误类型
│   ├── 📁 utils/                   # 工具函数
│   │   ├── 📄 helpers.ts                   # 通用帮助函数
│   │   ├── 📄 validation.ts                # 数据验证
│   │   ├── 📄 logger.ts                    # 日志工具
│   │   ├── 📄 constants.ts                 # 常量定义
│   │   └── 📄 env.ts                       # 环境变量处理
│   ├── 📁 config/                  # 配置文件
│   │   ├── 📄 database.ts                  # 数据库配置(未来)
│   │   ├── 📄 cors.ts                      # CORS配置
│   │   ├── 📄 coze.ts                      # Coze API配置
│   │   └── 📄 server.ts                    # 服务器配置
│   ├── 📁 __tests__/               # 测试文件
│   │   ├── 📁 controllers/                 # 控制器测试
│   │   ├── 📁 services/                    # 服务测试
│   │   ├── 📁 utils/                       # 工具测试
│   │   ├── 📄 setup.ts                     # 测试配置
│   │   └── 📄 helpers.ts                   # 测试辅助
│   └── 📄 app.ts                   # 应用主文件
├── 📁 dist/                        # 编译输出(gitignore)
├── 📁 logs/                        # 日志文件(gitignore)
├── 📄 package.json                 # 项目配置
├── 📄 tsconfig.json                # TypeScript配置
├── 📄 .eslintrc.json               # ESLint配置
├── 📄 .prettierrc                  # Prettier配置
├── 📄 .env.example                 # 环境变量示例
├── 📄 Dockerfile                   # Docker配置
├── 📄 .dockerignore                # Docker忽略文件
└── 📄 README.md                    # 后端说明文档
```

### 后端命名规范

#### 文件命名规范
```typescript
// 控制器文件 - camelCase + Controller后缀
healthController.ts
recommendController.ts
ingredientController.ts

// 服务文件 - camelCase + Service后缀
cozeService.ts
recommendService.ts
cacheService.ts

// 中间件文件 - camelCase
cors.ts
errorHandler.ts
validation.ts

// 类型文件 - camelCase
index.ts
request.ts
response.ts

// 工具文件 - camelCase
helpers.ts
validation.ts
constants.ts
```

#### 代码结构规范
```typescript
// 控制器文件结构示例
import { Request, Response, NextFunction } from 'express';
import { z } from 'zod';
import { RecommendService } from '@/services/recommendService';
import { validateRequest } from '@/utils/validation';
import { ApiResponse } from '@/types/response';

// 1. 请求验证Schema
const recommendRequestSchema = z.object({
  scene: z.enum(['party', 'date', 'alone', 'business', 'dining', 'night']),
  moods: z.array(z.string()).min(1).max(3),
  ingredients: z.object({
    spirits: z.array(z.string()),
    mixers: z.array(z.string()),
    tools: z.array(z.string()),
  }),
  // ... 其他字段
});

// 2. 控制器类
export class RecommendController {
  private recommendService: RecommendService;

  constructor() {
    this.recommendService = new RecommendService();
  }

  // 3. 路由处理方法
  getRecommendations = async (
    req: Request,
    res: Response<ApiResponse>,
    next: NextFunction
  ) => {
    try {
      // 验证请求
      const validatedData = validateRequest(recommendRequestSchema, req.body);
      
      // 调用服务
      const recommendations = await this.recommendService.getRecommendations(validatedData);
      
      // 返回响应
      res.status(200).json({
        success: true,
        data: recommendations,
        message: 'Recommendations generated successfully',
        timestamp: new Date().toISOString(),
      });
    } catch (error) {
      next(error);
    }
  };

  // 4. 其他方法...
}

// 5. 导出实例
export const recommendController = new RecommendController();
```

---

## 📚 文档文件结构

### 文档目录组织
```
docs/
├── 📁 requirements/                # 需求文档
│   ├── 📄 需求文档.md              # 主需求文档
│   ├── 📄 用户故事.md              # 用户故事
│   └── 📄 验收标准.md              # 验收标准
├── 📁 design/                      # 设计文档
│   ├── 📄 界面设计规范.md          # UI设计规范
│   ├── 📄 交互设计.md              # 交互设计
│   └── 📄 品牌指南.md              # 品牌指南
├── 📁 technical/                   # 技术文档
│   ├── 📄 技术规格.md              # 技术规格
│   ├── 📄 技术栈定型文档.md        # 技术栈
│   ├── 📄 项目文件结构规范.md      # 文件结构
│   └── 📄 安全合规.md              # 安全规范
├── 📁 development/                 # 开发文档
│   ├── 📄 开发环境搭建指南.md      # 环境搭建
│   ├── 📄 编码规范.md              # 编码规范
│   ├── 📄 测试规格.md              # 测试规范
│   └── 📄 代码审查清单.md          # 代码审查
├── 📁 deployment/                  # 部署文档
│   ├── 📄 部署指南.md              # 部署指南
│   ├── 📄 环境配置.md              # 环境配置
│   └── 📄 运维手册.md              # 运维手册
├── 📁 api/                         # API文档
│   ├── 📄 API规格.md               # API规格
│   ├── 📄 接口文档.md              # 接口文档
│   └── 📄 错误码.md                # 错误码说明
├── 📁 user-guide/                  # 用户指南
│   ├── 📄 用户手册.md              # 用户手册
│   ├── 📄 常见问题.md              # FAQ
│   └── 📄 故障排除.md              # 故障排除
└── 📁 project-management/          # 项目管理
    ├── 📄 项目规划.md              # 项目规划
    ├── 📄 里程碑.md                # 里程碑
    └── 📄 变更记录.md              # 变更记录
```

---

## 🛠️ 脚本和工具

### 脚本目录结构
```
scripts/
├── 📁 build/                       # 构建脚本
│   ├── 📄 build-frontend.sh        # 前端构建
│   ├── 📄 build-backend.sh         # 后端构建
│   └── 📄 build-all.sh             # 全量构建
├── 📁 deploy/                      # 部署脚本
│   ├── 📄 deploy-staging.sh        # 测试环境部署
│   ├── 📄 deploy-production.sh     # 生产环境部署
│   └── 📄 rollback.sh              # 回滚脚本
├── 📁 test/                        # 测试脚本
│   ├── 📄 run-tests.sh             # 运行测试
│   ├── 📄 e2e-tests.sh             # 端到端测试
│   └── 📄 performance-tests.sh     # 性能测试
├── 📁 database/                    # 数据库脚本(未来)
│   ├── 📄 migrate.sh               # 数据迁移
│   ├── 📄 seed.sh                  # 数据种子
│   └── 📄 backup.sh                # 数据备份
└── 📁 utils/                       # 工具脚本
    ├── 📄 setup-dev.sh             # 开发环境设置
    ├── 📄 clean.sh                 # 清理脚本
    └── 📄 health-check.sh          # 健康检查
```

---

## ⚙️ 配置文件规范

### 根目录配置文件
```
shaker/
├── 📄 .gitignore                   # Git忽略规则
├── 📄 .gitattributes               # Git属性配置
├── 📄 .nvmrc                       # Node版本锁定
├── 📄 .editorconfig                # 编辑器配置
├── 📄 .prettierrc                  # Prettier配置
├── 📄 .prettierignore              # Prettier忽略
├── 📄 LICENSE                      # 开源协议
├── 📄 README.md                    # 项目说明
├── 📄 CHANGELOG.md                 # 变更日志
├── 📄 CONTRIBUTING.md              # 贡献指南
└── 📄 package.json                 # 根包配置
```

### GitHub配置
```
.github/
├── 📁 workflows/                   # GitHub Actions
│   ├── 📄 ci.yml                   # 持续集成
│   ├── 📄 cd.yml                   # 持续部署
│   └── 📄 security.yml             # 安全扫描
├── 📁 ISSUE_TEMPLATE/              # Issue模板
│   ├── 📄 bug_report.md            # Bug报告
│   ├── 📄 feature_request.md       # 功能请求
│   └── 📄 question.md              # 问题咨询
├── 📁 PULL_REQUEST_TEMPLATE/       # PR模板
│   └── 📄 pull_request_template.md # PR模板
├── 📄 CODEOWNERS                   # 代码所有者
└── 📄 dependabot.yml               # 依赖更新
```

---

## 📝 命名约定总结

### 文件和目录命名
```bash
# 目录命名 - kebab-case
user-guide/
project-management/
api-documentation/

# React组件文件 - PascalCase
Button.tsx
CocktailCard.tsx
IngredientSelector.tsx

# 非组件TypeScript文件 - camelCase
helpers.ts
validation.ts
constants.ts

# 样式文件 - kebab-case
globals.css
components.css
reset.css

# 配置文件 - kebab-case 或固定名称
vite.config.ts
tailwind.config.js
.eslintrc.json
```

### 代码命名
```typescript
// 变量和函数 - camelCase
const userName = 'John';
const getUserRecommendations = () => {};

// 常量 - SCREAMING_SNAKE_CASE
const API_BASE_URL = 'https://api.example.com';
const MAX_RETRY_ATTEMPTS = 3;

// 类型和接口 - PascalCase
interface UserPreferences {}
type ApiResponse<T> = {};

// 枚举 - PascalCase
enum StatusCode {
  Success = 200,
  NotFound = 404,
  ServerError = 500,
}

// 组件 - PascalCase
const Button: React.FC = () => {};
const CocktailCard: React.FC = () => {};
```

---

## 🔍 代码组织最佳实践

### 导入顺序规范
```typescript
// 1. React相关导入
import React, { useState, useEffect } from 'react';
import { NextPage } from 'next';

// 2. 第三方库导入
import axios from 'axios';
import { z } from 'zod';
import clsx from 'clsx';

// 3. 项目内部导入 - 绝对路径
import { Button } from '@/components/ui/Button';
import { useAppStore } from '@/stores/useAppStore';
import { ApiResponse } from '@/types/api';

// 4. 相对路径导入
import './Component.css';
import { helperFunction } from '../utils/helpers';
```

### 文件大小建议
```typescript
// 文件大小建议
{
  "组件文件": "< 300行",
  "Hook文件": "< 150行", 
  "工具文件": "< 200行",
  "类型文件": "< 100行",
  "服务文件": "< 400行",
  "控制器文件": "< 200行"
}

// 超过建议大小时应考虑拆分
```

### 注释规范
```typescript
/**
 * 获取鸡尾酒推荐
 * @param userInput 用户输入的偏好信息
 * @returns Promise<CocktailRecommendation[]> 推荐结果列表
 * @throws {ValidationError} 当用户输入不符合要求时
 * @example
 * ```typescript
 * const recommendations = await getRecommendations({
 *   scene: 'party',
 *   moods: ['happy', 'excited'],
 *   ingredients: { spirits: ['vodka'], mixers: ['lime'] }
 * });
 * ```
 */
export async function getRecommendations(
  userInput: UserInput
): Promise<CocktailRecommendation[]> {
  // 实现逻辑...
}
```

---

## ✅ 项目结构检查清单

### 创建新文件时检查
- [ ] 文件放在正确的目录中
- [ ] 文件命名符合规范
- [ ] 导入语句按规范排序
- [ ] 导出语句清晰明确
- [ ] 必要的类型注解
- [ ] 适当的注释说明

### 重构时检查
- [ ] 文件大小合理
- [ ] 职责单一清晰
- [ ] 依赖关系合理
- [ ] 可测试性良好
- [ ] 文档更新同步

### 项目整体检查
- [ ] 目录结构清晰
- [ ] 命名一致性
- [ ] 依赖关系清晰
- [ ] 构建配置正确
- [ ] 文档完整性

---

*文档版本：v1.0*  
*最后更新：2024-08-28*  
*结构规范持续优化中*
