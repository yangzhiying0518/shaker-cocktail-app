# Shakeræ™ºèƒ½é¸¡å°¾é…’æ¨èç³»ç»Ÿæµ‹è¯•è§„æ ¼

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯
| é¡¹ç›® | å†…å®¹ |
|------|------|
| **äº§å“åç§°** | Shaker |
| **ç‰ˆæœ¬å·** | MVPç‰ˆæœ¬1.0.0 |
| **æ–‡æ¡£ç‰ˆæœ¬** | v1.0 |
| **åˆ›å»ºæ—¥æœŸ** | 2024-08-28 |
| **é¡¹ç›®è´Ÿè´£äºº** | éƒ­é” |
| **æ–‡æ¡£çŠ¶æ€** | âœ… å·²å®Œæˆ | 

---

## ğŸ¯ æµ‹è¯•ç­–ç•¥

### æµ‹è¯•ç›®æ ‡
> **ç¡®ä¿Shakeräº§å“è´¨é‡**ï¼šé€šè¿‡å…¨é¢çš„æµ‹è¯•è¦†ç›–ï¼Œä¿è¯åŠŸèƒ½æ­£ç¡®æ€§ã€æ€§èƒ½è¾¾æ ‡ã€ç”¨æˆ·ä½“éªŒä¼˜ç§€ã€‚

- **åŠŸèƒ½å®Œæ•´æ€§**ï¼šæ‰€æœ‰éœ€æ±‚åŠŸèƒ½æ­£ç¡®å®ç°
- **æ€§èƒ½è¾¾æ ‡**ï¼šå“åº”æ—¶é—´å’Œå¹¶å‘èƒ½åŠ›ç¬¦åˆè¦æ±‚
- **ç”¨æˆ·ä½“éªŒ**ï¼šç•Œé¢å‹å¥½ï¼Œäº¤äº’æµç•…
- **å…¼å®¹æ€§**ï¼šå¤šè®¾å¤‡ã€å¤šæµè§ˆå™¨æ”¯æŒ
- **ç¨³å®šæ€§**ï¼šé”™è¯¯å¤„ç†å®Œå–„ï¼Œç³»ç»Ÿç¨³å®š

### æµ‹è¯•åŸåˆ™
- **æµ‹è¯•é©±åŠ¨**ï¼šé‡è¦åŠŸèƒ½å…ˆå†™æµ‹è¯•
- **è‡ªåŠ¨åŒ–ä¼˜å…ˆ**ï¼šå‡å°‘æ‰‹åŠ¨æµ‹è¯•å·¥ä½œé‡
- **æŒç»­é›†æˆ**ï¼šä»£ç æäº¤å³è§¦å‘æµ‹è¯•
- **è¦†ç›–å…¨é¢**ï¼šåŠŸèƒ½ã€æ€§èƒ½ã€å®‰å…¨å…¨è¦†ç›–
- **ç”¨æˆ·è§†è§’**ï¼šä»ç”¨æˆ·è§’åº¦éªŒè¯åŠŸèƒ½

---

## ğŸ§ª æµ‹è¯•ç±»å‹å’Œæ¡†æ¶

### 1. å•å…ƒæµ‹è¯• (Unit Testing)

#### æµ‹è¯•æ¡†æ¶
```typescript
// å‰ç«¯å•å…ƒæµ‹è¯•
{
  "framework": "Vitest",
  "renderer": "jsdom",
  "library": "@testing-library/react",
  "coverage": "v8",
  "target": "80% coverage"
}

// åç«¯å•å…ƒæµ‹è¯•
{
  "framework": "Vitest", 
  "mocking": "vi.mock",
  "coverage": "v8",
  "target": "85% coverage"
}
```

#### æµ‹è¯•èŒƒå›´
- **å·¥å…·å‡½æ•°**ï¼šæ•°æ®éªŒè¯ã€æ ¼å¼åŒ–ã€è®¡ç®—é€»è¾‘
- **ç»„ä»¶é€»è¾‘**ï¼šReactç»„ä»¶çš„çŠ¶æ€å’Œè¡Œä¸º
- **APIæœåŠ¡**ï¼šä¸šåŠ¡é€»è¾‘å’Œæ•°æ®å¤„ç†
- **æ•°æ®æ¨¡å‹**ï¼šç±»å‹éªŒè¯å’Œè½¬æ¢

#### ç¤ºä¾‹æµ‹è¯•ç”¨ä¾‹
```typescript
// å‰ç«¯ç»„ä»¶æµ‹è¯•
describe('Button Component', () => {
  it('renders with correct text', () => {
    render(<Button>Click me</Button>);
    expect(screen.getByText('Click me')).toBeInTheDocument();
  });

  it('calls onClick when clicked', () => {
    const handleClick = vi.fn();
    render(<Button onClick={handleClick}>Click me</Button>);
    fireEvent.click(screen.getByText('Click me'));
    expect(handleClick).toHaveBeenCalledTimes(1);
  });

  it('shows loading state', () => {
    render(<Button loading>Click me</Button>);
    expect(screen.getByRole('button')).toBeDisabled();
    expect(screen.getByTestId('loading-spinner')).toBeInTheDocument();
  });
});

// åç«¯æœåŠ¡æµ‹è¯•
describe('RecommendService', () => {
  it('generates recommendations successfully', async () => {
    const mockInput = {
      scene: 'party',
      moods: ['happy'],
      ingredients: { spirits: ['vodka'] },
      preferences: { alcohol_level: 'medium' }
    };

    const result = await recommendService.getRecommendations(mockInput);
    
    expect(result).toHaveLength.greaterThan(0);
    expect(result[0]).toHaveProperty('name');
    expect(result[0]).toHaveProperty('recipe');
  });
});
```

### 2. é›†æˆæµ‹è¯• (Integration Testing)

#### æµ‹è¯•èŒƒå›´
- **APIé›†æˆ**ï¼šå‰åç«¯æ•°æ®æµæµ‹è¯•
- **å¤–éƒ¨æœåŠ¡**ï¼šCoze APIè°ƒç”¨æµ‹è¯•
- **ç»„ä»¶é›†æˆ**ï¼šå¤šç»„ä»¶åä½œæµ‹è¯•
- **è·¯ç”±æµ‹è¯•**ï¼šé¡µé¢è·³è½¬å’Œæ•°æ®ä¼ é€’

#### ç¤ºä¾‹æµ‹è¯•ç”¨ä¾‹
```typescript
// APIé›†æˆæµ‹è¯•
describe('Recommendation API Integration', () => {
  it('should return recommendations for valid input', async () => {
    const testInput = {
      scene: 'party',
      moods: ['happy', 'excited'],
      ingredients: {
        spirits: ['vodka', 'gin'],
        mixers: ['lime', 'tonic']
      },
      preferences: {
        alcohol_level: 'medium',
        sweetness: 'light'
      }
    };

    const response = await request(app)
      .post('/api/recommend')
      .send(testInput)
      .expect(200);

    expect(response.body.success).toBe(true);
    expect(response.body.data).toHaveLength.greaterThan(0);
    expect(response.body.data[0]).toMatchObject({
      name: expect.objectContaining({
        chinese: expect.any(String),
        english: expect.any(String)
      }),
      recipe: expect.objectContaining({
        ingredients: expect.any(Array),
        instructions: expect.any(Array)
      })
    });
  });
});
```

### 3. ç«¯åˆ°ç«¯æµ‹è¯• (E2E Testing)

#### æµ‹è¯•æ¡†æ¶
```typescript
{
  "framework": "Playwright",
  "browsers": ["chromium", "firefox", "webkit"],
  "viewports": ["mobile", "tablet", "desktop"],
  "headless": true,
  "parallel": true
}
```

#### æµ‹è¯•æµç¨‹
```typescript
// E2Eæµ‹è¯•ç”¨ä¾‹
describe('Complete Recommendation Flow', () => {
  test('user can get cocktail recommendations', async ({ page }) => {
    // 1. è®¿é—®é¦–é¡µ
    await page.goto('/');
    await expect(page.locator('h1')).toContainText('Shaker');

    // 2. å¼€å§‹æ¨èæµç¨‹
    await page.click('text=å¼€å§‹æ¨è');
    
    // 3. é€‰æ‹©åœºæ™¯
    await page.click('[data-testid="scene-party"]');
    await page.click('text=ä¸‹ä¸€æ­¥');

    // 4. é€‰æ‹©å¿ƒæƒ…
    await page.click('[data-testid="mood-happy"]');
    await page.click('[data-testid="mood-excited"]');
    await page.click('text=ä¸‹ä¸€æ­¥');

    // 5. é€‰æ‹©ææ–™
    await page.click('[data-testid="ingredient-vodka"]');
    await page.click('[data-testid="ingredient-lime"]');
    await page.click('text=ä¸‹ä¸€æ­¥');

    // 6. è®¾ç½®åå¥½
    await page.click('[data-testid="alcohol-medium"]');
    await page.click('text=è·å–æ¨è');

    // 7. éªŒè¯ç»“æœ
    await expect(page.locator('[data-testid="recommendation-card"]')).toHaveCount.greaterThan(0);
    await expect(page.locator('text=æ¨èç†ç”±')).toBeVisible();
  });
});
```

### 4. æ€§èƒ½æµ‹è¯• (Performance Testing)

#### æµ‹è¯•æŒ‡æ ‡
```typescript
{
  "é¡µé¢æ€§èƒ½": {
    "First Contentful Paint": "< 1.5s",
    "Largest Contentful Paint": "< 2.5s",
    "Cumulative Layout Shift": "< 0.1",
    "First Input Delay": "< 100ms"
  },
  "APIæ€§èƒ½": {
    "æ¨èæ¥å£å“åº”æ—¶é—´": "< 15s",
    "å…¶ä»–æ¥å£å“åº”æ—¶é—´": "< 500ms",
    "å¹¶å‘å¤„ç†èƒ½åŠ›": "100+ ç”¨æˆ·",
    "é”™è¯¯ç‡": "< 1%"
  }
}
```

#### æ€§èƒ½æµ‹è¯•å·¥å…·
```typescript
// Lighthouse CIé…ç½®
{
  "ci": {
    "collect": {
      "numberOfRuns": 3,
      "settings": {
        "preset": "desktop"
      }
    },
    "assert": {
      "assertions": {
        "categories:performance": ["error", {"minScore": 0.9}],
        "categories:accessibility": ["error", {"minScore": 0.9}],
        "categories:best-practices": ["error", {"minScore": 0.9}]
      }
    }
  }
}
```

---

## ğŸ“Š æµ‹è¯•ç”¨ä¾‹è®¾è®¡

### 1. åŠŸèƒ½æµ‹è¯•ç”¨ä¾‹

#### F01 - åœºæ™¯é€‰æ‹©åŠŸèƒ½
| ç”¨ä¾‹ID | æµ‹è¯•åœºæ™¯ | æµ‹è¯•æ­¥éª¤ | é¢„æœŸç»“æœ | ä¼˜å…ˆçº§ |
|--------|----------|----------|----------|--------|
| TC_F01_001 | æ­£å¸¸é€‰æ‹©åœºæ™¯ | 1. è¿›å…¥åœºæ™¯é€‰æ‹©é¡µ<br>2. ç‚¹å‡»"èšä¼šæ´¾å¯¹"å¡ç‰‡ | å¡ç‰‡è¢«é€‰ä¸­é«˜äº®æ˜¾ç¤º | P0 |
| TC_F01_002 | åˆ‡æ¢åœºæ™¯é€‰æ‹© | 1. é€‰æ‹©"èšä¼šæ´¾å¯¹"<br>2. ç‚¹å‡»"æµªæ¼«çº¦ä¼š" | å‰ä¸€é€‰æ‹©å–æ¶ˆï¼Œæ–°é€‰æ‹©ç”Ÿæ•ˆ | P0 |
| TC_F01_003 | æœªé€‰æ‹©æ—¶ç‚¹å‡»ä¸‹ä¸€æ­¥ | 1. ä¸é€‰æ‹©ä»»ä½•åœºæ™¯<br>2. ç‚¹å‡»ä¸‹ä¸€æ­¥ | æ˜¾ç¤ºé”™è¯¯æç¤ºï¼Œé˜»æ­¢ç»§ç»­ | P1 |

#### F02 - å¿ƒæƒ…é€‰æ‹©åŠŸèƒ½
| ç”¨ä¾‹ID | æµ‹è¯•åœºæ™¯ | æµ‹è¯•æ­¥éª¤ | é¢„æœŸç»“æœ | ä¼˜å…ˆçº§ |
|--------|----------|----------|----------|--------|
| TC_F02_001 | é€‰æ‹©å•ä¸ªå¿ƒæƒ… | 1. ç‚¹å‡»"å¼€å¿ƒæ„‰æ‚¦"æ ‡ç­¾ | æ ‡ç­¾è¢«é€‰ä¸­é«˜äº® | P0 |
| TC_F02_002 | é€‰æ‹©å¤šä¸ªå¿ƒæƒ… | 1. é€‰æ‹©"å¼€å¿ƒæ„‰æ‚¦"<br>2. é€‰æ‹©"å…´å¥‹æ¿€åŠ¨" | ä¸¤ä¸ªæ ‡ç­¾éƒ½è¢«é€‰ä¸­ | P0 |
| TC_F02_003 | è¶…è¿‡æœ€å¤§é€‰æ‹©æ•° | 1. é€‰æ‹©3ä¸ªå¿ƒæƒ…<br>2. å°è¯•é€‰æ‹©ç¬¬4ä¸ª | æ˜¾ç¤ºæç¤ºï¼Œé˜»æ­¢é€‰æ‹© | P1 |

#### F03 - AIæ¨èåŠŸèƒ½
| ç”¨ä¾‹ID | æµ‹è¯•åœºæ™¯ | æµ‹è¯•æ­¥éª¤ | é¢„æœŸç»“æœ | ä¼˜å…ˆçº§ |
|--------|----------|----------|----------|--------|
| TC_F03_001 | æ­£å¸¸è·å–æ¨è | 1. å®Œæˆæ‰€æœ‰è¾“å…¥<br>2. ç‚¹å‡»è·å–æ¨è | è¿”å›3-5ä¸ªæ¨èç»“æœ | P0 |
| TC_F03_002 | APIè¶…æ—¶å¤„ç† | 1. æ¨¡æ‹ŸAPIè¶…æ—¶<br>2. è§‚å¯Ÿç³»ç»Ÿååº” | æ˜¾ç¤ºè¶…æ—¶æç¤ºï¼Œæä¾›é‡è¯• | P1 |
| TC_F03_003 | æ— æ•ˆè¾“å…¥å¤„ç† | 1. æäº¤æ— æ•ˆæ•°æ®<br>2. è§‚å¯Ÿç³»ç»Ÿååº” | æ˜¾ç¤ºéªŒè¯é”™è¯¯ï¼Œé˜»æ­¢æäº¤ | P1 |

### 2. è¾¹ç•Œæµ‹è¯•ç”¨ä¾‹

#### è¾¹ç•Œå€¼æµ‹è¯•
| æµ‹è¯•é¡¹ | è¾¹ç•Œå€¼ | æµ‹è¯•ç”¨ä¾‹ | é¢„æœŸç»“æœ |
|--------|--------|----------|----------|
| å¿ƒæƒ…é€‰æ‹©æ•°é‡ | 0ä¸ª | ä¸é€‰æ‹©å¿ƒæƒ…ç‚¹å‡»ä¸‹ä¸€æ­¥ | æ˜¾ç¤ºé”™è¯¯æç¤º |
| å¿ƒæƒ…é€‰æ‹©æ•°é‡ | 1ä¸ª | é€‰æ‹©1ä¸ªå¿ƒæƒ… | æ­£å¸¸é€šè¿‡ |
| å¿ƒæƒ…é€‰æ‹©æ•°é‡ | 3ä¸ª | é€‰æ‹©3ä¸ªå¿ƒæƒ… | æ­£å¸¸é€šè¿‡ |
| å¿ƒæƒ…é€‰æ‹©æ•°é‡ | 4ä¸ª | å°è¯•é€‰æ‹©4ä¸ªå¿ƒæƒ… | é˜»æ­¢é€‰æ‹©ï¼Œæ˜¾ç¤ºæç¤º |
| ç‰¹æ®Šè¦æ±‚æ–‡æœ¬ | 0å­—ç¬¦ | ç©ºæ–‡æœ¬è¾“å…¥ | æ¥å—ç©ºå€¼ |
| ç‰¹æ®Šè¦æ±‚æ–‡æœ¬ | 100å­—ç¬¦ | è¾“å…¥100å­—ç¬¦æ–‡æœ¬ | æ­£å¸¸æ¥å— |
| ç‰¹æ®Šè¦æ±‚æ–‡æœ¬ | 500å­—ç¬¦ | è¾“å…¥è¶…é•¿æ–‡æœ¬ | æˆªæ–­æˆ–æç¤ºé™åˆ¶ |

### 3. å¼‚å¸¸æµ‹è¯•ç”¨ä¾‹

#### ç½‘ç»œå¼‚å¸¸æµ‹è¯•
| ç”¨ä¾‹ID | å¼‚å¸¸åœºæ™¯ | æ¨¡æ‹Ÿæ–¹å¼ | é¢„æœŸå¤„ç† |
|--------|----------|----------|----------|
| TC_E01_001 | ç½‘ç»œæ–­å¼€ | ç¦ç”¨ç½‘ç»œè¿æ¥ | æ˜¾ç¤ºç½‘ç»œé”™è¯¯æç¤º |
| TC_E01_002 | æœåŠ¡å™¨500é”™è¯¯ | Mock 500å“åº” | æ˜¾ç¤ºæœåŠ¡å™¨é”™è¯¯æç¤º |
| TC_E01_003 | APIå“åº”è¶…æ—¶ | å»¶è¿Ÿå“åº”>15ç§’ | æ˜¾ç¤ºè¶…æ—¶æç¤ºï¼Œæä¾›é‡è¯• |
| TC_E01_004 | è¿”å›æ ¼å¼é”™è¯¯ | Mockæ— æ•ˆJSON | æ˜¾ç¤ºæ•°æ®é”™è¯¯æç¤º |

---

## ğŸ”§ æµ‹è¯•ç¯å¢ƒé…ç½®

### 1. æµ‹è¯•ç¯å¢ƒæ­å»º

#### å‰ç«¯æµ‹è¯•ç¯å¢ƒ
```typescript
// vitest.config.ts
import { defineConfig } from 'vitest/config';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
  test: {
    globals: true,
    environment: 'jsdom',
    setupFiles: ['./src/__tests__/setup.ts'],
    coverage: {
      provider: 'v8',
      reporter: ['text', 'json', 'html'],
      exclude: [
        'node_modules/',
        'src/__tests__/',
        '**/*.d.ts',
        '**/*.config.*',
      ],
    },
  },
});
```

#### åç«¯æµ‹è¯•ç¯å¢ƒ
```typescript
// vitest.config.ts (backend)
import { defineConfig } from 'vitest/config';

export default defineConfig({
  test: {
    globals: true,
    environment: 'node',
    setupFiles: ['./src/__tests__/setup.ts'],
    coverage: {
      provider: 'v8',
      reporter: ['text', 'json', 'html'],
      thresholds: {
        global: {
          branches: 80,
          functions: 80,
          lines: 80,
          statements: 80,
        },
      },
    },
  },
});
```

### 2. Mocké…ç½®

#### API Mock
```typescript
// src/__tests__/mocks/cozeApi.ts
export const mockCozeResponse = {
  recommendations: [
    {
      name: {
        chinese: "è«å‰æ‰˜",
        english: "Mojito"
      },
      reason: "æ¸…çˆ½çš„è–„è·å‘³é€‚åˆèšä¼šæ°›å›´",
      recipe: {
        ingredients: [
          { name: "ç™½æœ—å§†é…’", amount: "60ml" },
          { name: "é’æŸ æ±", amount: "30ml" },
          { name: "è–„è·å¶", amount: "10ç‰‡" }
        ],
        tools: ["è°ƒé…’å™¨", "æ…æ‹Œæ£’"],
        difficulty: "ç®€å•"
      }
    }
  ]
};

// Mock Coze API
vi.mock('@/services/cozeService', () => ({
  getRecommendations: vi.fn().mockResolvedValue(mockCozeResponse)
}));
```

### 3. æµ‹è¯•æ•°æ®ç®¡ç†

#### æµ‹è¯•æ•°æ®é›†
```typescript
// src/__tests__/fixtures/testData.ts
export const validUserInput = {
  scene: 'party' as const,
  moods: ['happy', 'excited'] as const,
  ingredients: {
    spirits: ['vodka', 'gin'],
    mixers: ['lime', 'tonic', 'ice'],
    tools: ['shaker', 'jigger']
  },
  preferences: {
    alcohol_level: 'medium' as const,
    sweetness: 'light' as const,
    acidity: 'medium' as const,
    style: 'fresh' as const,
    color: 'any' as const
  },
  special_requirements: 'å¸Œæœ›é¢œå€¼é«˜ä¸€äº›'
};

export const invalidUserInput = {
  scene: 'invalid_scene',
  moods: [],
  ingredients: {
    spirits: [],
    mixers: [],
    tools: []
  }
};
```

---

## ğŸ“ˆ æµ‹è¯•è¦†ç›–ç‡è¦æ±‚

### 1. è¦†ç›–ç‡ç›®æ ‡

#### å‰ç«¯è¦†ç›–ç‡
```typescript
{
  "è¯­å¥è¦†ç›–ç‡": "â‰¥ 80%",
  "åˆ†æ”¯è¦†ç›–ç‡": "â‰¥ 75%", 
  "å‡½æ•°è¦†ç›–ç‡": "â‰¥ 85%",
  "è¡Œè¦†ç›–ç‡": "â‰¥ 80%"
}
```

#### åç«¯è¦†ç›–ç‡
```typescript
{
  "è¯­å¥è¦†ç›–ç‡": "â‰¥ 85%",
  "åˆ†æ”¯è¦†ç›–ç‡": "â‰¥ 80%",
  "å‡½æ•°è¦†ç›–ç‡": "â‰¥ 90%", 
  "è¡Œè¦†ç›–ç‡": "â‰¥ 85%"
}
```

### 2. é‡ç‚¹æµ‹è¯•æ¨¡å—

#### å¿…é¡»100%è¦†ç›–çš„æ¨¡å—
- æ•°æ®éªŒè¯å‡½æ•°
- é”™è¯¯å¤„ç†é€»è¾‘
- å®‰å…¨ç›¸å…³ä»£ç 
- æ ¸å¿ƒä¸šåŠ¡é€»è¾‘

#### å¯é€‚å½“é™ä½è¦†ç›–ç‡çš„æ¨¡å—
- UIç»„ä»¶æ ·å¼ä»£ç 
- ç¬¬ä¸‰æ–¹åº“å°è£…
- é…ç½®æ–‡ä»¶
- å¸¸é‡å®šä¹‰

---

## ğŸ”„ æµ‹è¯•æµç¨‹å’ŒCI/CD

### 1. æµ‹è¯•æ‰§è¡Œæµç¨‹

```mermaid
graph TD
    A[ä»£ç æäº¤] --> B[è‡ªåŠ¨è§¦å‘CI]
    B --> C[å®‰è£…ä¾èµ–]
    C --> D[ä»£ç æ£€æŸ¥]
    D --> E[å•å…ƒæµ‹è¯•]
    E --> F[é›†æˆæµ‹è¯•]
    F --> G[æ„å»ºåº”ç”¨]
    G --> H[E2Eæµ‹è¯•]
    H --> I{æµ‹è¯•é€šè¿‡?}
    I -->|æ˜¯| J[éƒ¨ç½²æµ‹è¯•ç¯å¢ƒ]
    I -->|å¦| K[é€šçŸ¥å¼€å‘è€…]
    J --> L[æ€§èƒ½æµ‹è¯•]
    L --> M[éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒ]
    K --> N[ä¿®å¤é—®é¢˜]
    N --> A
```

### 2. GitHub Actionsé…ç½®

```yaml
# .github/workflows/test.yml
name: Test Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test-frontend:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
        working-directory: ./frontend
      
      - name: Run unit tests
        run: npm run test:coverage
        working-directory: ./frontend
      
      - name: Upload coverage
        uses: codecov/codecov-action@v3
        with:
          directory: ./frontend/coverage

  test-backend:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
        working-directory: ./backend
      
      - name: Run unit tests
        run: npm run test:coverage
        working-directory: ./backend

  e2e-test:
    runs-on: ubuntu-latest
    needs: [test-frontend, test-backend]
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
      
      - name: Install dependencies
        run: |
          cd frontend && npm ci
          cd ../backend && npm ci
      
      - name: Start services
        run: |
          cd backend && npm start &
          cd frontend && npm run build && npm run preview &
          
      - name: Run E2E tests
        run: npx playwright test
```

---

## ğŸ“Š æµ‹è¯•æŠ¥å‘Šå’Œç›‘æ§

### 1. æµ‹è¯•æŠ¥å‘Šæ ¼å¼

#### æµ‹è¯•æ‰§è¡ŒæŠ¥å‘Š
```typescript
interface TestReport {
  summary: {
    total: number;
    passed: number;
    failed: number;
    skipped: number;
    duration: string;
  };
  coverage: {
    statements: number;
    branches: number;
    functions: number;
    lines: number;
  };
  failedTests: Array<{
    name: string;
    error: string;
    file: string;
    line: number;
  }>;
  performance: {
    slowestTests: Array<{
      name: string;
      duration: string;
    }>;
  };
}
```

### 2. è´¨é‡é—¨ç¦

#### å¿…é¡»æ»¡è¶³çš„æ¡ä»¶
- [ ] æ‰€æœ‰P0æµ‹è¯•ç”¨ä¾‹é€šè¿‡
- [ ] ä»£ç è¦†ç›–ç‡è¾¾åˆ°è¦æ±‚
- [ ] æ€§èƒ½æµ‹è¯•æŒ‡æ ‡è¾¾æ ‡
- [ ] å®‰å…¨æµ‹è¯•æ— é«˜å±æ¼æ´
- [ ] E2Eæµ‹è¯•æ ¸å¿ƒæµç¨‹é€šè¿‡

#### è­¦å‘Šæ¡ä»¶
- [ ] P1æµ‹è¯•ç”¨ä¾‹å¤±è´¥ < 5%
- [ ] è¦†ç›–ç‡ä¸‹é™ > 5%
- [ ] æ€§èƒ½æŒ‡æ ‡è½»å¾®è¶…æ ‡
- [ ] æ–°å¢ä¸­ä½å±å®‰å…¨é—®é¢˜

---

## ğŸ” æµ‹è¯•æœ€ä½³å®è·µ

### 1. æµ‹è¯•ç¼–å†™åŸåˆ™

#### FIRSTåŸåˆ™
- **Fast**: æµ‹è¯•è¿è¡Œå¿«é€Ÿ
- **Independent**: æµ‹è¯•ä¹‹é—´ç›¸äº’ç‹¬ç«‹
- **Repeatable**: æµ‹è¯•ç»“æœå¯é‡å¤
- **Self-Validating**: æµ‹è¯•æœ‰æ˜ç¡®çš„é€šè¿‡/å¤±è´¥ç»“æœ
- **Timely**: æµ‹è¯•åŠæ—¶ç¼–å†™ï¼Œä¸æ‹–åˆ°æœ€å

#### AAAæ¨¡å¼
```typescript
describe('UserService', () => {
  it('should create user successfully', () => {
    // Arrange - å‡†å¤‡æµ‹è¯•æ•°æ®
    const userData = { name: 'John', email: 'john@example.com' };
    const mockRepository = createMockRepository();
    
    // Act - æ‰§è¡Œè¢«æµ‹è¯•çš„æ“ä½œ
    const result = userService.createUser(userData);
    
    // Assert - éªŒè¯ç»“æœ
    expect(result).toEqual(expectedUser);
    expect(mockRepository.save).toHaveBeenCalledWith(userData);
  });
});
```

### 2. æµ‹è¯•ç»´æŠ¤

#### å®šæœŸæ¸…ç†
- åˆ é™¤è¿‡æ—¶çš„æµ‹è¯•ç”¨ä¾‹
- æ›´æ–°æµ‹è¯•æ•°æ®
- é‡æ„é‡å¤çš„æµ‹è¯•ä»£ç 
- ä¼˜åŒ–æ…¢é€Ÿæµ‹è¯•

#### æµ‹è¯•æ–‡æ¡£
- æµ‹è¯•ç”¨ä¾‹è¦æœ‰æ¸…æ™°çš„æè¿°
- å¤æ‚æµ‹è¯•é€»è¾‘è¦æœ‰æ³¨é‡Š
- ç»´æŠ¤æµ‹è¯•ç”¨ä¾‹æ¸…å•
- è®°å½•å·²çŸ¥é—®é¢˜å’Œé™åˆ¶

---

## âœ… æµ‹è¯•å®Œæˆæ ‡å‡†

### åŠŸèƒ½æµ‹è¯•å®Œæˆæ ‡å‡†
- [ ] æ‰€æœ‰éœ€æ±‚åŠŸèƒ½éƒ½æœ‰å¯¹åº”æµ‹è¯•ç”¨ä¾‹
- [ ] P0çº§åˆ«æµ‹è¯•ç”¨ä¾‹100%é€šè¿‡
- [ ] P1çº§åˆ«æµ‹è¯•ç”¨ä¾‹é€šè¿‡ç‡â‰¥95%
- [ ] è¾¹ç•Œå€¼å’Œå¼‚å¸¸åœºæ™¯è¦†ç›–å®Œæ•´

### æ€§èƒ½æµ‹è¯•å®Œæˆæ ‡å‡†
- [ ] é¡µé¢åŠ è½½æ€§èƒ½è¾¾æ ‡
- [ ] APIå“åº”æ—¶é—´ç¬¦åˆè¦æ±‚
- [ ] å¹¶å‘å‹åŠ›æµ‹è¯•é€šè¿‡
- [ ] å†…å­˜ä½¿ç”¨åœ¨åˆç†èŒƒå›´

### å…¼å®¹æ€§æµ‹è¯•å®Œæˆæ ‡å‡†
- [ ] ä¸»æµæµè§ˆå™¨æµ‹è¯•é€šè¿‡
- [ ] ç§»åŠ¨è®¾å¤‡é€‚é…æ­£å¸¸
- [ ] ä¸åŒå±å¹•å°ºå¯¸æ˜¾ç¤ºæ­£ç¡®
- [ ] é”®ç›˜æ“ä½œæ”¯æŒå®Œæ•´

---

*æ–‡æ¡£ç‰ˆæœ¬ï¼šv1.0*  
*æœ€åæ›´æ–°ï¼š2024-08-28*  
*æµ‹è¯•è§„æ ¼æŒç»­å®Œå–„ä¸­*
